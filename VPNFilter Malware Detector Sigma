title: VPNFilter Malware Detector.
description: VPNFilter Malware Detector.
references:
- https://blog.talosintelligence.com/2018/05/VPNFilter.html
- https://ssu.gov.ua/ua/news/1/category/2/view/4823#.fceLIKev.dpbs
- https://www.reuters.com/article/us-cyber-routers-ukraine/cyber-firms-ukraine-warn-of-planned-russian-attack-idUSKCN1IO1U9
- https://blogs.cisco.com/security/talos/vpnfilter
author: Alexandr Yamposlkyi, SOC Prime
status: testing
logsource:
  product: windows
  service: sysmon
detection:
  selectionHash:
    EventID: "1"
    file_hash:
    - 50ac4fcd3fbc8abcaa766449841b3a0a684b3e217fc40935f1ac22c34c58a9ec
    - 0e0094d9bd396a6594da8e21911a3982cd737b445f591581560d766755097d92
    - 9683b04123d7e9fe4c8c26c69b09c2233f7e1440f828837422ce330040782d17
    - d6097e942dd0fdc1fb28ec1814780e6ecc169ec6d24f9954e71954eedbc4c70e
    - 4b03288e9e44d214426a02327223b5e516b1ea29ce72fa25a2fcef9aa65c4b0b
    - 9eb6c779dbad1b717caa462d8e040852759436ed79cc2172692339bc62432387
    - 37e29b0ea7a9b97597385a12f525e13c3a7d02ba4161a6946f2a7d978cc045b4
    - 776cb9a7a9f5afbaffdd4dbd052c6420030b2c7c3058c1455e0a79df0e6f7a1d
    - 8a20dc9538d639623878a3d3d18d88da8b635ea52e5e2d0c2cce4a8c5a703db1
    - 0649fda8888d701eb2f91e6e0a05a2e2be714f564497c44a3813082ef8ff250b
    - f8286e29faa67ec765ae0244862f6b7914fcdde10423f96595cb84ad5cc6b344
    - afd281639e26a717aead65b1886f98d6d6c258736016023b4e59de30b7348719
---
logsource:
  product: proxy
detection:
  selectionURL:
    URL:
    - photobucket.com/user/nikkireed11/library
    - photobucket.com/user/nikkireed11/library
    - photobucket.com/user/kmila302/library
    - photobucket.com/user/lisabraun87/library
    - photobucket.com/user/eva_green1/library
    - photobucket.com/user/monicabelci4/library
    - photobucket.com/user/katyperry45/library
    - photobucket.com/user/saragray1/library
    - photobucket.com/user/millerfred/library
    - photobucket.com/user/jeniferaniston1/library
    - photobucket.com/user/amandaseyfried1/library
    - photobucket.com/user/suwe8/library
    - photobucket.com/user/bob7301/library
    - toknowall.com
  keywords:
  - 6b57dcnonk2edf5a.onion/bin32/update.php
  - tljmmy4vmkqbdof4.onion/bin32/update.php
  - zuh3vcyskd4gipkm.onion/bin32/update.php
  - 6b57dcnonk2edf5a.onion/bin32/update.php
---
logsource:
  product: firewall
detection:
  selectionIP:
    SuorceIP:
    - 91.121.109.209
    - 217.12.202.40
    - 94.242.222.68
    - 82.118.242.124
    - 46.151.209.33
    - 217.79.179.14
    - 91.214.203.144
    - 95.211.198.231
    - 195.154.180.60
    - 5.149.250.54
    - 91.200.13.76
    - 94.185.80.82
    - 62.210.180.229
    - 91.200.13.76
    - 23.111.177.114
    DestinationIP:
    - 91.121.109.209
    - 217.12.202.40
    - 94.242.222.68
    - 82.118.242.124
    - 46.151.209.33
    - 217.79.179.14
    - 91.214.203.144
    - 95.211.198.231
    - 195.154.180.60
    - 5.149.250.54
    - 91.200.13.76
    - 94.185.80.82
    - 62.210.180.229
    - 91.200.13.76
    - 23.111.177.114
  condition: selectionHash or selectionURL or keywords or selectionIP
fields:
- Image
- User
- TargetObject
- Hashes
- DestinationIp
- SourceIp
- URL
- UserAgent
falsepositives:
- Unknown
level: high
mitre-attack:
  Persistence:
  - Component Firmware
  - Component Object Model Hijacking
  - External Remote Services
  Command and Control:
  - Remote File Copy
  - Standard Application Layer Protocol
  - Web Service
